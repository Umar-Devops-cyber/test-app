
# Spring Boot Web Application with Docker and GitHub Actions

This project demonstrates how to create a simple Spring Boot web application, dockerize it, and automate the build and deployment process using GitHub Actions.

## Prerequisites

Before starting, make sure you have the following installed on your machine:
- **Java 17+** (for running the Spring Boot application)
- **Gradle** (for building the project)
- **Docker** (for containerizing the application)
- **Git** (for version control)
- **GitHub Account** (for hosting the repository and configuring GitHub Actions)

---

## 1. **Create a Spring Boot Application**

First, we'll generate a Spring Boot project using [Spring Initializr](https://start.spring.io/).

1. Go to [Spring Initializr](https://start.spring.io/).
2. Select the following options:
   - **Project**: Gradle Project
   - **Language**: Java
   - **Spring Boot Version**: 3.1.3 (or latest)
   - **Dependencies**: Add `Spring Web`
   - **Group**: `com.example`
   - **Artifact**: `my-web-app`
3. Click **Generate** to download the project as a `.zip` file.
4. Extract the `.zip` file and open the project in your IDE.

---

## 2. **Build and Run the Application Locally**

### **Navigate to the Project Directory**
Open a terminal/command prompt and navigate to the root directory of the extracted project:

```bash
cd my-web-app
```

### **Build the Project with Gradle**

Run the following command to build the project:

```bash
./gradlew build
```

- **Explanation**: This command uses Gradle to compile the project and package it into a `.jar` file located in the `build/libs` directory.

### **Run the Application Locally**

To run the application locally, use the following command:

```bash
./gradlew bootRun
```

- **Explanation**: This command starts the Spring Boot application. You can access it by navigating to `http://localhost:8080` in your browser. The application will display "Hello, World!" when accessed.

---

## 3. **Dockerize the Application**

### **Create a Dockerfile**

In the root directory of your project, create a file named `Dockerfile` with the following content:

```dockerfile
# Use an official Java runtime as a parent image
FROM openjdk:17-jdk-slim

# Set the working directory
WORKDIR /app

# Copy the project JAR file into the container
COPY build/libs/my-web-app-0.0.1-SNAPSHOT.jar app.jar

# Expose the application port
EXPOSE 8080

# Run the JAR file
ENTRYPOINT ["java", "-jar", "app.jar"]
```

- **Explanation**:
  - `FROM openjdk:17-jdk-slim`: This line specifies the base image for the Docker container, which is an official Java 17 image.
  - `WORKDIR /app`: Sets the working directory inside the container.
  - `COPY build/libs/my-web-app-0.0.1-SNAPSHOT.jar app.jar`: Copies the `.jar` file generated by Gradle into the container.
  - `EXPOSE 8080`: Exposes port `8080` so that the application can be accessed.
  - `ENTRYPOINT ["java", "-jar", "app.jar"]`: Runs the JAR file when the container starts.

### **Build the Docker Image**

Run the following command to build the Docker image:

```bash
docker build -t my-web-app .
```

- **Explanation**: This command tells Docker to build an image named `my-web-app` using the `Dockerfile` in the current directory (`.`).

### **Run the Docker Container**

To run the Docker container, use the following command:

```bash
docker run -p 8080:8080 my-web-app
```

- **Explanation**: This command runs the Docker container and maps port `8080` on your machine to port `8080` in the container. You can access the application at `http://localhost:8080`.

---

## 4. **Push the Code to GitHub**

### **Initialize a Git Repository**

Run the following commands to initialize a Git repository:

```bash
git init
git add .
git commit -m "Initial commit"
```

- **Explanation**: These commands initialize a Git repository, add all files to the staging area, and commit them with the message "Initial commit."

### **Push to GitHub**

Create a new repository on GitHub and push the code to it:

```bash
git branch -M main
git remote add origin <your-repo-url>
git push -u origin main
```

- **Explanation**: These commands push the local repository to a new GitHub repository. Replace `<your-repo-url>` with the URL of your GitHub repository.

---

## 5. **Configure GitHub Actions**

GitHub Actions automates the build and deployment process.

### **Create GitHub Actions Workflow**

1. In your GitHub repository, create a `.github/workflows` directory.
2. Inside this directory, create a file named `docker-build.yml` with the following content:

```yaml
name: Build and Push Docker Image

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # Checkout the code
    - name: Checkout code
      uses: actions/checkout@v3

    # Set up JDK
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'  # Add this line to specify the JDK distribution
    # Cache Gradle dependencies
    - name: Cache Gradle dependencies
      uses: actions/cache@v3
      with:
        path: ~/.gradle/caches
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}
        restore-keys: |
          ${{ runner.os }}-gradle

    # Build the project
    - name: Build with Gradle
      run: ./gradlew build

    # Build Docker image
    - name: Build Docker image
      run: docker build -t umerbloch/my-web-app .

    # Log in to DockerHub
    - name: Log in to DockerHub
      uses: docker/login-action@v2
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}

    # Push Docker image to DockerHub
    - name: Push Docker image
      run: docker push umerbloch/my-web-app
```

- **Explanation**:
  - `on.push.branches`: Triggers the workflow when changes are pushed to the `main` branch.
  - `actions/checkout@v3`: Checks out the code from the repository.
  - `actions/setup-java@v3`: Sets up Java 17 for building the project.
  - `./gradlew build`: Builds the project using Gradle.
  - `docker build -t <your-dockerhub-username>/my-web-app .`: Builds the Docker image.
  - `docker/login-action@v2`: Logs into DockerHub using your credentials stored in GitHub secrets.
  - `docker push`: Pushes the Docker image to DockerHub.

### **Add DockerHub Credentials to GitHub Secrets**

1. Go to your GitHub repository's **Settings**.
2. Navigate to **Secrets and Variables > Actions**.
3. Add the following secrets:
   - `DOCKER_USERNAME`: Your DockerHub username.
   - `DOCKER_PASSWORD`: Your DockerHub password.

---

## 6. **Test the GitHub Actions Workflow**

1. Push changes to the `main` branch:

```bash
git add .
git commit -m "Add GitHub Actions workflow"
git push origin main
```

2. GitHub Actions will automatically trigger the workflow, building the Docker image and pushing it to DockerHub.

---

## Conclusion

You have successfully created a Spring Boot web application, dockerized it, and set up GitHub Actions for automated build and deployment. Now, every time you push changes to the `main` branch, the Docker image will be rebuilt and pushed to DockerHub.

---
